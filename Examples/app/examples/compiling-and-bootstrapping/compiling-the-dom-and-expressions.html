<!doctype html>
<html ng-app="app">
<head>
  <script src="/lib/angular/angular.js"></script>
</head>
<body>
  <div ng-controller="Ctrl1" nick="ctrl1">
    <input type="text" ng-model="val1">
    {{$log.log(1, 'ctrl1', val1)}}
  </div>

  <div ng-controller="Ctrl2" nick="ctrl2">
    <input type="text" ng-model="val1">
    {{$log.log(2, 'ctrl2', val1)}}

    <div ng-controller="Ctrl3" nick="ctrl3">
      <input type="text" ng-model="val1">
      {{$log.log(2, 'ctrl3', val1)}}
    </div>
  </div>

<script>
var app = angular.module('app', []).run(function ($rootScope, $log) {
  $rootScope.$log = $log;
})

app.controller('Ctrl1', function($scope) {});
app.controller('Ctrl2', function($scope) {});
app.controller('Ctrl3', function($scope) {});

app.directive('nick', function () {
  return {
    restrict : 'A',
    controller : function ($attrs) {
      console.log('controller', $attrs.nick);
    },
    compile : function (el, attr) {
      name = attr.nick;
      console.log('compile', attr.nick);
      return function link () {
        console.log('link', attr.nick);
      }
    }
  }
})



</script>
</body>
</html>